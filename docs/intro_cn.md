# 用户手册


## 介绍

LabelImgViaPC是一款通过激光点云标注图像的工具，主要原理是在激光点云上标注三维目标(立方体), 通过点云和图像之间的映射关系获得图像上目标信息；

此软件支持通过透视图调整三维目标；由于点云和图像经常不能完美匹配，此软件支持在图像上对映射点进行调整（三维目标不变）；

同时为了减少用户开发工作量，我们也提供内外参标定服务，自动三维目标生成服务。



## 配置

为了简化软件界面，通过config.ini文件进行所有的配置管理，具体可以参考配置文件 bin/config.ini

关于相机模型，我们使用全向相机CMei模型(参考Single View Point Omnidirectional Camera Calibration from Planar Grids)，因为全向模型通用性更好，对普通相机、广角相机和鱼眼相机的支持都比较好

关于相机内参标定，建议一个相机对应一套内参数，因为即使同一款相机也会由于制作工艺的原因导致内参一致性方面存在误差



## 标注

### 标注主要流程：

标注前请注意左上角许可证状态，如果无效，则不能保存标签文件

1.	File List列表框中双击选择PCD文件

2.	鼠标左键单击点云视图，鼠标左右键、滚轮配合使用调整视角

3.	键盘w键进入新建模式，点云视图中单击鼠标左键，移动鼠标再次单击左键获得完整目标

4.	"Current Class"下拉框能设置目标类型

5.	通过键盘调整三维目标位姿，常用（q、w、e、a、s、d、z、x），不常用（c、v、b、n），不常用快捷键用来调整pitch和roll（需将config.ini->z_rotation_only设置为false）；
也可以通过点云投影图(俯视图、前视图、侧视图)来调整三维目标

6.	调整三维目标在图像上的二维投影，可以选中Labels标签栏 "P0~P7"中一项或多项，通过键盘(w、a、s、d)调整位置，手动调整二维目标后的框会改变目标颜色，如需删除手动调整结果，则用delete键删除；请注意手动调整二维目标后，三维目标不再向对应图像进行自动二维投影

7.	设置目标是否可见，通过在小图上双击左键可切换二维目标的可见状态

8.	保存，双击File List列表框PCD文件切换文件时会自动进行保存；也可以通过Ctrl+s快捷键保存，快捷键保存时不要选中目标，双击点云试图中的非目标位置或单击Deselect按钮能取消选中



## 标签文件

一个PCD文件对应一个JSON标签文件，包含的字段如下：

"folder"：PCD文件夹

"filename"：PCD文件名

"path"：PCD完整路径

"objects"：三维目标

"name"：目标类型

"centroid"：三维目标中心

"dimensions"：三维目标长宽高

"rotations": 三维目标旋转角度，[0, 360)

"visibles"：三维目标到各个图像的映射目标是否可见

"img_bboxes"：三维目标到各个图像的映射目标，如果为空则为自动映射，如有值则为手动调整



## 常见问题

1、	快捷键按钮没有反应

软件快捷键的主要逻辑是先用鼠标点击激活相关窗口，然后再使用快捷键操作，这样可以减少快捷键数量


